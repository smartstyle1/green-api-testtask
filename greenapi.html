<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>GREEN-API Interface</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 30px; display: flex; gap: 40px; }
        /* Левая колонка */
        .input-panel { width: 320px; display: flex; flex-direction: column; gap: 15px; }
        /* Правая колонка */
        .output-panel { flex-grow: 1; display: flex; flex-direction: column; }
        
        input, textarea { 
            padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px; 
        }
        button { 
            padding: 10px; cursor: pointer; background-color: #f8f9fa; 
            border: 1px solid #ccc; border-radius: 4px; text-align: center;
        }
        button:hover { background-color: #e9ecef; }
        
        .method-group { display: flex; flex-direction: column; gap: 8px; margin-bottom: 10px; }
        label { font-weight: bold; margin-bottom: 5px; display: block; }
        
        #responseOutput { 
            width: 100%; height: 500px; font-family: monospace; 
            white-space: pre-wrap; resize: none;
        }
    </style>
</head>
<body>

    <div class="input-panel">
        <input type="text" id="idInstance" placeholder="idInstance">
        <input type="text" id="apiTokenInstance" placeholder="ApiTokenInstance">

        <button onclick="callGetApi('getSettings')">getSettings</button>
        <button onclick="callGetApi('getStateInstance')">getStateInstance</button>

        <div class="method-group">
            <input type="text" id="phoneMsg" placeholder="77771234567">
            <textarea id="textMsg" placeholder="Hello World!" style="height: 60px;"></textarea>
            <button onclick="sendMessage()">sendMessage</button>
        </div>

        <div class="method-group">
            <input type="text" id="phoneFile" placeholder="77771234567">
            <input type="text" id="fileUrl" placeholder="https://my.site.com/img/horse.png">
            <button onclick="sendFileByUrl()">sendFileByUrl</button>
        </div>
    </div>

    <div class="output-panel">
        <label>Ответ:</label>
        <textarea id="responseOutput" readonly></textarea>
    </div>

    <script>
        const getCredentials = () => ({
            id: document.getElementById('idInstance').value,
            token: document.getElementById('apiTokenInstance').value
        });

        const showResponse = (data) => {
            document.getElementById('responseOutput').value = JSON.stringify(data, null, 4);
        };

        async function callGetApi(method) {
            const { id, token } = getCredentials();
            try {
                const response = await fetch(`https://api.green-api.com/waInstance${id}/${method}/${token}`);
                showResponse(await response.json());
            } catch (e) { alert('Ошибка: ' + e.message); }
        }

        async function sendMessage() {
            const { id, token } = getCredentials();
            const payload = {
                chatId: `${document.getElementById('phoneMsg').value}@c.us`,
                message: document.getElementById('textMsg').value
            };
            try {
                const response = await fetch(`https://api.green-api.com/waInstance${id}/sendMessage/${token}`, {
                    method: 'POST', body: JSON.stringify(payload)
                });
                showResponse(await response.json());
            } catch (e) { alert('Ошибка: ' + e.message); }
        }

        async function sendFileByUrl() {
            const { id, token } = getCredentials();
            const url = document.getElementById('fileUrl').value;
            const payload = {
                chatId: `${document.getElementById('phoneFile').value}@c.us`,
                urlFile: url,
                fileName: url.split('/').pop() || 'file'
            };
            try {
                const response = await fetch(`https://api.green-api.com/waInstance${id}/sendFileByUrl/${token}`, {
                    method: 'POST', body: JSON.stringify(payload)
                });
                showResponse(await response.json());
            } catch (e) { alert('Ошибка: ' + e.message); }
        }
    </script>
</body>
</html>